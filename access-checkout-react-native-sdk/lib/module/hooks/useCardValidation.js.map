{"version":3,"names":["useEffect","NativeEventEmitter","AccessCheckout","AccessCheckoutReactNative","cardValidationNativeEventListenerOf","ValidationListenerException","useCardValidationEventListener","validationListener","nativeEventListener","nativeEventEmitter","eventSubscription","addListener","CardValidationEventType","remove","useCardValidation","accessCheckout","cardValidationConfig","initialiseCardValidation"],"sources":["useCardValidation.ts"],"sourcesContent":["import { useEffect } from 'react';\nimport { NativeEventEmitter } from 'react-native';\nimport AccessCheckout from '../AccessCheckout';\nimport AccessCheckoutReactNative from '../AccessCheckoutReactNative';\nimport {\n  CardValidationEventListener,\n  cardValidationNativeEventListenerOf,\n} from '../validation/CardValidationEventListener';\nimport { ValidationListenerException } from '../validation/ValidationListenerException';\n\nexport function useCardValidationEventListener(validationListener: CardValidationEventListener) {\n  useEffect(() => {\n    //Safe-guard in the case where no validation listener was configured we avoid registering the native listener\n    if (!validationListener) {\n      return;\n    }\n\n    const nativeEventListener = cardValidationNativeEventListenerOf(validationListener);\n    const nativeEventEmitter = new NativeEventEmitter(AccessCheckoutReactNative);\n\n    const eventSubscription = nativeEventEmitter.addListener(\n      AccessCheckout.CardValidationEventType,\n      nativeEventListener\n    );\n\n    return () => {\n      eventSubscription.remove();\n    };\n  }, []);\n}\n\ninterface UseCardValidationHook {\n  accessCheckout: AccessCheckout;\n  cardValidationConfig: {\n    panId: string;\n    expiryDateId: string;\n    cvcId: string;\n    enablePanFormatting?: boolean;\n    acceptedCardBrands?: string[];\n  };\n  validationListener: CardValidationEventListener;\n}\n\nexport function useCardValidation({ accessCheckout, cardValidationConfig, validationListener }: UseCardValidationHook) {\n  /*\n  Implementation Note: To allow the hook to render and use hooks correctly:\n  `useCardValidationEventListener` has a safe-guard inside its useEffect to check if a validationListener\n  was provided in order to register the native event.\n  */\n  useCardValidationEventListener(validationListener);\n\n  const initialiseCardValidation = () => {\n    /*\n    Implementation Note: Since we do not block the rendering of the hook to allow for `validationConfig` to be optional.\n    We added a safe-guard that will raise a ValidationListenerException which prevents the\n    `initialiseCardValidation` method from being called when no validationConfig is provided.\n    This provides the developers with a clear readable error message and enhances their debugging experience.\n     */\n    if (!validationListener) {\n      throw new ValidationListenerException();\n    }\n    return accessCheckout.initialiseCardValidation(cardValidationConfig);\n  };\n\n  return { initialiseCardValidation };\n}\n"],"mappings":"AAAA,SAASA,SAAS,QAAQ,OAAO;AACjC,SAASC,kBAAkB,QAAQ,cAAc;AACjD,OAAOC,cAAc,MAAM,mBAAmB;AAC9C,OAAOC,yBAAyB,MAAM,8BAA8B;AACpE,SAEEC,mCAAmC,QAC9B,2CAA2C;AAClD,SAASC,2BAA2B,QAAQ,2CAA2C;AAEvF,OAAO,SAASC,8BAA8BA,CAACC,kBAA+C,EAAE;EAC9FP,SAAS,CAAC,MAAM;IACd;IACA,IAAI,CAACO,kBAAkB,EAAE;MACvB;IACF;IAEA,MAAMC,mBAAmB,GAAGJ,mCAAmC,CAACG,kBAAkB,CAAC;IACnF,MAAME,kBAAkB,GAAG,IAAIR,kBAAkB,CAACE,yBAAyB,CAAC;IAE5E,MAAMO,iBAAiB,GAAGD,kBAAkB,CAACE,WAAW,CACtDT,cAAc,CAACU,uBAAuB,EACtCJ,mBACF,CAAC;IAED,OAAO,MAAM;MACXE,iBAAiB,CAACG,MAAM,CAAC,CAAC;IAC5B,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;AACR;AAcA,OAAO,SAASC,iBAAiBA,CAAC;EAAEC,cAAc;EAAEC,oBAAoB;EAAET;AAA0C,CAAC,EAAE;EACrH;AACF;AACA;AACA;AACA;EACED,8BAA8B,CAACC,kBAAkB,CAAC;EAElD,MAAMU,wBAAwB,GAAGA,CAAA,KAAM;IACrC;AACJ;AACA;AACA;AACA;AACA;IACI,IAAI,CAACV,kBAAkB,EAAE;MACvB,MAAM,IAAIF,2BAA2B,CAAC,CAAC;IACzC;IACA,OAAOU,cAAc,CAACE,wBAAwB,CAACD,oBAAoB,CAAC;EACtE,CAAC;EAED,OAAO;IAAEC;EAAyB,CAAC;AACrC"}